import{V as d}from"./z-iqEL2o.min.js";const e={STARTED:"started",LOADED:"loaded",ENTER:"enter",EXIT:"exit",RESET:"reset"},l=1200,n=500;class h extends HTMLElement{constructor(){super(...arguments),this.words=[],this.currentActive=0,this.started=!1}connectedCallback(){this.words=this.getSlotElements("word");const t=this.getSlotElement("video");this.video=new d(t),this.toggleButton=this.getSlotElement("toggle-button");const s=new IntersectionObserver(i=>{this.started||i.forEach(o=>{o.isIntersecting&&(this.started=!0,s.disconnect(),this.init())})},{threshold:.4});s.observe(this)}async init(){new ResizeObserver(()=>this.updateVars()).observe(this),window.requestAnimationFrame(()=>this.start())}async start(){await this.video.load(),this.classList.add(e.STARTED),this.video.getElement().addEventListener("play",()=>{this.classList.add(e.LOADED)}),this.words.length>0&&this.enter(this.words[0]),window.setTimeout(()=>{if(this.words.forEach((t,s)=>{const i=Number(t.getAttribute("data-timestamp")||"0");this.video.addTimestampListener(i,()=>{this.enter(t)});const o=s===this.words.length-1;let r=0;if(o)r=this.video.getDuration()-n;else{const a=this.words[s+1];r=Number(a.getAttribute("data-timestamp")||"0")-n}this.video.addTimestampListener(r,()=>this.exit(t))}),this.toggleButton){this.toggleButton.addEventListener("click",()=>this.toggle());const t=this.video.getElement();t.addEventListener("play",()=>{this.toggleButton.setAttribute("aria-pressed","true")}),t.addEventListener("pause",()=>{this.toggleButton.setAttribute("aria-pressed","false")})}this.video.play(400)},l)}updateVars(){window.requestAnimationFrame(()=>{this.words.forEach(t=>this.updateWordVars(t))})}updateWordVars(t){const s=t.firstElementChild.offsetWidth||0;t.style.setProperty("--word-width",`${s}px`)}enter(t){this.updateWordVars(t),t.classList.add(e.ENTER)}exit(t){t.classList.add(e.EXIT),window.setTimeout(()=>{this.reset(t)},n)}reset(t){window.requestAnimationFrame(()=>{t.classList.add(e.RESET),window.requestAnimationFrame(()=>{t.classList.remove(e.ENTER),t.classList.remove(e.EXIT),window.requestAnimationFrame(()=>{t.classList.remove(e.RESET)})})})}toggle(){const t=this.video.getElement();t.paused?t.play():t.pause()}getSlotElement(t){return this.querySelector(`[data-slot="${t}"]`)}getSlotElements(t){return Array.from(this.querySelectorAll(`[data-slot="${t}"]`))}}customElements.get("photos-overview-hero")||customElements.define("photos-overview-hero",h);
